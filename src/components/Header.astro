---
// Header component for marketing site
// Auth links point to app.getanswerlayer.com

const appUrl = 'https://app.getanswerlayer.com';
const docsUrl = 'https://docs.getanswerlayer.com';

interface Props {
  currentPath?: string;
}

const { currentPath = '' } = Astro.props;
---

<header class="w-full py-5 border-b bg-white/90 backdrop-blur-sm fixed top-0 z-50">
  <div class="container-custom flex justify-between items-center">
    <!-- Logo -->
    <div class="flex items-center gap-2.5">
      <a href="/" class="flex items-center gap-2.5" aria-label="AnswerLayer Home">
        <div class="h-12 w-11 rounded-lg bg-gradient-to-r from-navy-500 to-navy-700 flex flex-col items-center justify-center shadow-sm py-1">
          <span class="text-white font-serif font-bold text-sm mb-0.5">A</span>
          <svg xmlns="http://www.w3.org/2000/svg" class="text-white h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <ellipse cx="12" cy="5" rx="9" ry="3"></ellipse>
            <path d="M3 5V19A9 3 0 0 0 21 19V5"></path>
            <path d="M3 12A9 3 0 0 0 21 12"></path>
          </svg>
        </div>
        <span class="font-serif font-bold text-xl tracking-tight">AnswerLayer</span>
      </a>
    </div>

    <!-- Desktop Navigation -->
    <nav class="hidden md:flex items-center gap-10" aria-label="Main Navigation">
      <!-- Product Dropdown -->
      <div class="relative group">
        <button
          class="flex items-center gap-1 text-sm font-medium text-gray-900 hover:text-navy-600 transition-colors focus:outline-none focus:ring-2 focus:ring-navy-500 focus:ring-offset-2 rounded-md px-2 py-1"
          aria-expanded="false"
          aria-haspopup="true"
        >
          Product
          <svg class="h-3 w-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </button>
        <div class="absolute left-0 mt-2 w-60 p-1 bg-white border border-gray-200 shadow-lg rounded-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
          <a href="/product" class="block px-3 py-2 rounded-md hover:bg-gray-50 transition-colors">
            <div class="font-medium text-gray-900 text-sm">Product Overview</div>
          </a>
          <a href="/ai-analytics" class="block px-3 py-2 rounded-md hover:bg-gray-50 transition-colors">
            <div class="font-medium text-gray-900 text-sm">AI-Powered Analytics</div>
          </a>
          <a href="/semantic-layer" class="block px-3 py-2 rounded-md hover:bg-gray-50 transition-colors">
            <div class="font-medium text-gray-900 text-sm">Semantic Layer</div>
          </a>
          <a href="/privacy-protection" class="block px-3 py-2 rounded-md hover:bg-gray-50 transition-colors">
            <div class="font-medium text-gray-900 text-sm">Privacy Protection</div>
          </a>
          <div class="border-t border-gray-100 my-1"></div>
          <a href={docsUrl} target="_blank" rel="noopener noreferrer" class="block px-3 py-2 rounded-md hover:bg-gray-50 transition-colors">
            <div class="font-medium text-gray-900 text-sm">API Documentation</div>
          </a>
        </div>
      </div>

      <a
        href="/pricing"
        class="text-sm font-medium text-gray-900 hover:text-navy-600 transition-colors focus:outline-none focus:ring-2 focus:ring-navy-500 focus:ring-offset-2 rounded-md px-2 py-1"
      >
        Pricing
      </a>
      <a
        href="/faq"
        class="text-sm font-medium text-gray-900 hover:text-navy-600 transition-colors focus:outline-none focus:ring-2 focus:ring-navy-500 focus:ring-offset-2 rounded-md px-2 py-1"
      >
        FAQ
      </a>
      <a
        href="/open-source"
        class="text-sm font-medium text-gray-900 hover:text-navy-600 transition-colors focus:outline-none focus:ring-2 focus:ring-navy-500 focus:ring-offset-2 rounded-md px-2 py-1"
      >
        Open Source
      </a>
    </nav>

    <!-- Auth Buttons -->
    <div class="hidden md:flex items-center gap-3">
      <a
        href={`${appUrl}/sign-in`}
        class="btn btn-outline btn-sm"
        aria-label="Sign In"
      >
        Sign In
      </a>
      <a
        href={`${appUrl}/sign-up?redirect=connections%2Fnew`}
        class="btn btn-primary btn-sm"
        aria-label="Sign Up"
      >
        Sign Up
      </a>
    </div>

    <!-- Mobile Menu Button -->
    <button
      id="mobile-menu-button"
      class="md:hidden p-2 text-gray-500 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-navy-500 focus:ring-offset-2 rounded-md"
      aria-label="Open menu"
      aria-expanded="false"
      aria-controls="mobile-menu"
    >
      <svg id="menu-icon" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
      <svg id="close-icon" class="h-6 w-6 hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>
  </div>

  <!-- Mobile Menu -->
  <div
    id="mobile-menu"
    class="md:hidden absolute top-[72px] left-0 right-0 bg-white border-b shadow-lg z-50 hidden"
    aria-label="Mobile Navigation"
  >
    <div class="container-custom py-6 flex flex-col gap-5">
      <a href="/product" class="px-4 py-2.5 text-gray-900 font-medium rounded-md hover:bg-navy-50 transition-colors">
        Product Overview
      </a>
      <a href="/ai-analytics" class="px-4 py-2.5 text-gray-900 font-medium rounded-md hover:bg-navy-50 transition-colors">
        AI-Powered Analytics
      </a>
      <a href="/semantic-layer" class="px-4 py-2.5 text-gray-900 font-medium rounded-md hover:bg-navy-50 transition-colors">
        Semantic Layer
      </a>
      <a href="/privacy-protection" class="px-4 py-2.5 text-gray-900 font-medium rounded-md hover:bg-navy-50 transition-colors">
        Privacy Protection
      </a>
      <a href={docsUrl} target="_blank" rel="noopener noreferrer" class="px-4 py-2.5 text-gray-900 font-medium rounded-md hover:bg-navy-50 transition-colors">
        API Documentation
      </a>
      <a href="/pricing" class="px-4 py-2.5 text-gray-900 font-medium rounded-md hover:bg-navy-50 transition-colors">
        Pricing
      </a>
      <a href="/faq" class="px-4 py-2.5 text-gray-900 font-medium rounded-md hover:bg-navy-50 transition-colors">
        FAQ
      </a>
      <a href="/open-source" class="px-4 py-2.5 text-gray-900 font-medium rounded-md hover:bg-navy-50 transition-colors">
        Open Source
      </a>
      <div class="flex flex-col gap-3 pt-4 border-t">
        <a
          href={`${appUrl}/sign-in`}
          class="btn btn-outline w-full justify-center"
          aria-label="Sign In"
        >
          Sign In
        </a>
        <a
          href={`${appUrl}/sign-up?redirect=connections%2Fnew`}
          class="btn btn-primary w-full justify-center"
          aria-label="Sign Up"
        >
          Sign Up
        </a>
      </div>
    </div>
  </div>
</header>

<script>
  // Mobile menu toggle
  const menuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');
  const menuIcon = document.getElementById('menu-icon');
  const closeIcon = document.getElementById('close-icon');

  menuButton?.addEventListener('click', () => {
    const isOpen = mobileMenu?.classList.contains('hidden');

    if (isOpen) {
      mobileMenu?.classList.remove('hidden');
      mobileMenu?.classList.add('animate-fade-in');
      menuIcon?.classList.add('hidden');
      closeIcon?.classList.remove('hidden');
      menuButton?.setAttribute('aria-expanded', 'true');
      menuButton?.setAttribute('aria-label', 'Close menu');
    } else {
      mobileMenu?.classList.add('hidden');
      mobileMenu?.classList.remove('animate-fade-in');
      menuIcon?.classList.remove('hidden');
      closeIcon?.classList.add('hidden');
      menuButton?.setAttribute('aria-expanded', 'false');
      menuButton?.setAttribute('aria-label', 'Open menu');
    }
  });

  // Close menu when clicking a link
  mobileMenu?.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      mobileMenu?.classList.add('hidden');
      menuIcon?.classList.remove('hidden');
      closeIcon?.classList.add('hidden');
      menuButton?.setAttribute('aria-expanded', 'false');
    });
  });
</script>
